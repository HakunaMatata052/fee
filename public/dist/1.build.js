webpackJsonp([1],{649:function(t,e,o){"use strict";function n(t){o(660)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(655),i=o(662),r=o(259),s=n,l=r(a.a,i.a,!1,s,null,null);e.default=l.exports},651:function(t,e){function o(t,e){var o=t[1]||"",a=t[3];if(!a)return o;if(e&&"function"==typeof btoa){var i=n(a);return[o].concat(a.sources.map(function(t){return"/*# sourceURL="+a.sourceRoot+t+" */"})).concat([i]).join("\n")}return[o].join("\n")}function n(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=o(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},a=0;a<this.length;a++){var i=this[a][0];"number"==typeof i&&(n[i]=!0)}for(a=0;a<t.length;a++){var r=t[a];"number"==typeof r[0]&&n[r[0]]||(o&&!r[2]?r[2]=o:o&&(r[2]="("+r[2]+") and ("+o+")"),e.push(r))}},e}},652:function(t,e,o){function n(t){for(var e=0;e<t.length;e++){var o=t[e],n=c[o.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](o.parts[a]);for(;a<o.parts.length;a++)n.parts.push(i(o.parts[a]));n.parts.length>o.parts.length&&(n.parts.length=o.parts.length)}else{for(var r=[],a=0;a<o.parts.length;a++)r.push(i(o.parts[a]));c[o.id]={id:o.id,refs:1,parts:r}}}}function a(){var t=document.createElement("style");return t.type="text/css",d.appendChild(t),t}function i(t){var e,o,n=document.querySelector("style["+g+'~="'+t.id+'"]');if(n){if(f)return m;n.parentNode.removeChild(n)}if(y){var i=h++;n=u||(u=a()),e=r.bind(null,n,i,!1),o=r.bind(null,n,i,!0)}else n=a(),e=s.bind(null,n),o=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else o()}}function r(t,e,o,n){var a=o?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,a);else{var i=document.createTextNode(a),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(i,r[e]):t.appendChild(i)}}function s(t,e){var o=e.css,n=e.media,a=e.sourceMap;if(n&&t.setAttribute("media",n),v.ssrId&&t.setAttribute(g,e.id),a&&(o+="\n/*# sourceURL="+a.sources[0]+" */",o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var p=o(653),c={},d=l&&(document.head||document.getElementsByTagName("head")[0]),u=null,h=0,f=!1,m=function(){},v=null,g="data-vue-ssr-id",y="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,o,a){f=o,v=a||{};var i=p(t,e);return n(i),function(e){for(var o=[],a=0;a<i.length;a++){var r=i[a],s=c[r.id];s.refs--,o.push(s)}e?(i=p(t,e),n(i)):i=[];for(var a=0;a<o.length;a++){var s=o[a];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete c[s.id]}}}};var b=function(){var t=[];return function(e,o){return t[e]=o,t.filter(Boolean).join("\n")}}()},653:function(t,e){t.exports=function(t,e){for(var o=[],n={},a=0;a<e.length;a++){var i=e[a],r=i[0],s=i[1],l=i[2],p=i[3],c={id:t+":"+a,css:s,media:l,sourceMap:p};n[r]?n[r].parts.push(c):o.push(n[r]={id:r,parts:[c]})}return o}},655:function(t,e,o){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a={data:function(){return{list:[],list_car:[],search:{year:"",month:"",customer:""},loading:!0}},created:function(){var t=this;t.search.year=(new Date).getFullYear(),t.search.month=(new Date).getMonth()+1,null==localStorage.mm||0==localStorage.mm.length?t.open():t.getList(localStorage.mm,t.search.year+"-"+t.search.month)},methods:{open:function(){var t=this,e=this;this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var o=t.value;localStorage.setItem("mm",o),e.getList(localStorage.mm)}).catch(function(){t.$message({type:"error",message:"取消输入"})})},getList:function(t,e,o){var n=this;null==o&&(o=""),n.$http.get(n.$status.api+"/get/?mm="+t+"&date=&customer="+o).then(function(t){n.list=t.data.data,n.loading=!1})},searchFn:function(){var t=this;t.loading=!0,t.getList(localStorage.mm,"",t.search.customer)},submit:function(){var t=this;0!=t.list_car.length?(t.$http.post(t.$status.api+"/complete",{data:t.list_car}).then(function(e){t.getList(localStorage.mm)}),t.exportExcel()):alert("没有选择任何东西")},handleSelectionChange:function(t){this.list_car=t},exportExcel:function(){for(var t=[],e=this.list_car.length-1;e>=0;e--){var o=[],n=0;for(var a in this.list_car[e])"uid"==a||"designer"==a||(o[n]={value:"",type:"ROW_HEADER"},null==this.list_car[e][a]?o[n].value=" ":""==this.list_car[e][a]&&(o[n].value=" "),o[n].value=this.list_car[e][a]),n++;t.push(o)}var i={title:[{value:"编号",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"分公司",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"商务",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"设计",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"程序",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"公司名称",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"签单日期",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"下单日期",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"签单金额",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"实到金额",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"尾款",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"类型",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"工作量",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"提成",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"总监签字",type:"ROW_HEADER_HEADER",datatype:"string"},{value:"备注",type:"ROW_HEADER_HEADER",datatype:"string"}],data:t};this.JSONToExcelConvertor(i.data,this.list_car[0].fee+((new Date).getMonth()+1)+"月工作量表",i.title,this.list_car[0].fee)},JSONToExcelConvertor:function(t,e,o,a){var i="object"!=(void 0===t?"undefined":n(t))?JSON.parse(t):t,r='<table style="border-collapse: collapse;">';r+='<tr style="height: 25px;"><td colspan="12" style="font-weight: bold;">动力无限技术___'+a+"___"+(new Date).getFullYear()+"年___"+((new Date).getMonth()+1)+'__月网站上传统计</td><td  colspan="4" style="text-align: left;">技术确认金额签字:</td></tr>';for(var s="<tr>",l=0,p=o.length;l<p;l++)s+="<td style='font-size: 10pt;'>"+o[l].value+"</td>";r+=s+"</tr>";for(var l=0;l<i.length;l++){var s='<tr style="height:16pt;line-height:16pt">';s+='<td style="height:16pt;font-size:11pt;width:30px">'+l+"</td>",s+='<td style="height:16pt;font-size:11pt;width:60px">'+i[l][1].value+"</td>",s+='<td style="height:16pt;font-size:11pt;width:65px">'+i[l][2].value+"</td>",s+='<td style="height:16pt;font-size:11pt;width:65px">'+i[l][16].value.split("/")[0]+"</td>",s+='<td style="height:16pt;font-size:11pt;width:65px">'+i[l][16].value.split("/")[1]+"</td>",s+='<td style="height:16pt;font-size:11pt;width:315px">'+i[l][3].value+"</td>",s+='<td style="height:16pt;font-size:9pt;width:60px">'+i[l][4].value+"</td>",s+='<td style="height:16pt;font-size:9pt;width:60px">'+i[l][5].value+"</td>",s+='<td style="height:16pt;font-size:10pt;width:40px">'+i[l][6].value+"</td>",s+='<td style="height:16pt;font-size:10pt;width:40px">'+i[l][7].value+"</td>",s+='<td style="height:16pt;font-size:11pt;width:60px"></td>',s+='<td style="height:16pt;font-size:11pt;width:65px">'+i[l][8].value+"</td>",s+='<td style="height:16pt;font-size:11pt;width:50px"></td>',s+='<td style="height:16pt;font-size:11pt;width:45px"></td>',s+='<td style="height:16pt;font-size:11pt;width:70px"></td>',s+='<td style="height:16pt;font-size:11pt;width:80px"></td>',r+=s+"</tr>"}r+="</table>";var c="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";c+='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">',c+='<meta http-equiv="content-type" content="application/vnd.ms-excel',c+='; charset=UTF-8">',c+="<head>",c+="\x3c!--[if gte mso 9]>",c+="<xml>",c+="<x:ExcelWorkbook>",c+="<x:ExcelWorksheets>",c+="<x:ExcelWorksheet>",c+="<x:Name>",c+="工作量表",c+="</x:Name>",c+="<x:WorksheetOptions>",c+="<x:DisplayGridlines/>",c+="</x:WorksheetOptions>",c+="</x:ExcelWorksheet>",c+="</x:ExcelWorksheets>",c+="</x:ExcelWorkbook>",c+="</xml>",c+="<![endif]--\x3e",c+="<style>",c+="*{margin:0;padding:0;}td{border:thin solid #999;}",c+='      \x3c!-- @page\n        {mso-footer-data:"&C\\7B2C &P \\9875\\FF0C\\5171 &N \\9875";\n        margin:0.748in 0.195in 0.748in 0.195in;\n        mso-header-margin:0.91in;\n        mso-footer-margin:0.91in;}\n      --\x3e',c+="</style>",c+="</head>",c+='<body style="font-family:微软雅黑;text-align: center;">',c+=r,c+="</body>",c+="</html>";var d="data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(c),u=document.createElement("a");u.href=d,u.style="visibility:hidden",u.download=e+".xls",document.body.appendChild(u),u.click(),document.body.removeChild(u)},jump:function(t,e,o){this.$router.push({path:t+"/"+e+"/"+o})},fortime:function(t){var e=new Date(t),o=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),i=e.getHours(),r=e.getMinutes(),s=e.getSeconds();return o+"-"+this.add(n)+"-"+this.add(a)+" "+this.add(i)+":"+this.add(r)+":"+this.add(s)},add:function(t){return t<10?"0"+t:t}}}},660:function(t,e,o){var n=o(661);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o(652)("6ccc536b",n,!0,{})},661:function(t,e,o){e=t.exports=o(651)(!1),e.push([t.i,"body{padding-bottom:50px}.search{display:flex;background:#eee;padding:10px}.inline-input{min-width:300px;margin-right:20px}.tijiao{position:fixed;width:500px;height:320px;bottom:0;right:0;border:3px solid rgba(0,0,0,.3)}.submit{width:90%;margin:0 5%;position:fixed;left:0;bottom:10px;z-index:999}",""])},662:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app"},[o("div",{staticClass:"search"},[o("el-input",{staticClass:"inline-input",attrs:{placeholder:"单子名称"},model:{value:t.search.customer,callback:function(e){t.$set(t.search,"customer",e)},expression:"search.customer"}}),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.searchFn}},[t._v("搜索")])],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.list,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),o("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"fee",label:"前端",width:"80","show-overflow-tooltip":"",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"company",label:"分公司",width:"80","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"designer",label:"设计",width:"80","show-overflow-tooltip":"",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"programmer",label:"程序",width:"80","show-overflow-tooltip":"",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"business",label:"商务",width:"80","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"customer",label:"公司名称","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"qdate",label:"签单时间",width:"100","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"xdate",label:"下单时间",width:"100","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"qmoney",label:"签单金额",width:"80","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"smoney",label:"实到金额",width:"100","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"type",label:"类型",width:"110","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.html?o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){t.jump(e.row.uid,e.row.customer,e.row.fee)}}},[t._v("上传静态")]):o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.fortime(Number(e.row.html)),placement:"top-start"}},[o("el-tag",{attrs:{type:"success"}},[t._v("静态已上传")])],1)]}}])})],1),t._v(" "),o("br"),t._v(" "),o("el-button",{staticClass:"submit",attrs:{type:"success"},on:{click:t.submit}},[t._v("提交")])],1)},a=[],i={render:n,staticRenderFns:a};e.a=i}});